# 背景

通过监控链上(sol网络)交易的消息，根据一些特征，过滤出目标钱包地址。在目标钱包符合某些操作时进行买/卖。

# 技术分析

整个系统可以分为几个模块：

![[量化meme系统架构.excalidraw]]

## 链上监控系统

### 目的

通过自建节点的 rpc 供应商的 websocket 来获取实时的链上消息。
- rpc供应商：helius
### 消息监控原理

1. websocket 链接到 rpc
2. 订阅对某一地址的消息
3. 收到交易消息，提取其中的交易地址
4. 调用交易详情api，获取交易详情

## 过滤系统
### 目的

对链上海量的消息，进行过滤，筛选出策略需要的交易，再进一步筛选出目标的钱包。

### 多级过滤

链上消息是全量的，需要经过至少两步过滤：
1. 过滤出与 memecoin 相关的交易信息：mint、swap 还有？？
2. 对过滤出的消息，查询该交易涉及的钱包，根据一定的规则决定该钱包是否要关注

### 过滤规则引擎

由于规则会随着市场变化，进行高频的修改；频繁修改代码部署更新不是一个好方式。需要将过滤规则提出来，动态的更新维护。

## 广播系统

### 目的

将过滤出的消息，实时广播到客户端（网站 or 软件），供用户盯盘使用

### 实现

提供 websocket，供下游订阅。

## 交易系统

### 目的

在过滤出的目标钱包进行一些行为时，跟着做买入、卖出行为；或者达到一定的止盈、止损条件时进行卖出。

## 数据存储

## 目的

对链上交易、过滤后的结果等做存储；在链上消息产生时，能够查询数据库做过滤。

## 存储分类

根据数据量、读写要求、数据类型区分，主要有两大类的存储：
- 只读、高频写入：链上消息，使用 clickhouse
- 读写，不高频：过滤出的钱包、交易操作记录、规则、用户信息等。使用 pgsql

# 技术实现

## 架构

- 前端：Nextjs全栈（mksaas），实现前端页面 + 用户管理 + 数据展示
- 底层系统：监控、过滤、广播、交易、存储

![[项目结构.excalidraw]]

核心系统